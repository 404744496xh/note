### Xpathç®€ä»‹
XPathæ˜¯ä¸€ç§ç”¨äºåœ¨[XML](https://blog.csdn.net/weixin_50020236/article/details/126314990?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167947782316782427410461%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167947782316782427410461&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-126314990-null-null.142%5Ev76%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=XML&spm=1018.2226.3001.4187)æ–‡æ¡£ä¸­å®šä½èŠ‚ç‚¹çš„è¯­è¨€ï¼Œå®ƒå¯ä»¥ç”¨äºä»XMLæ–‡æ¡£ä¸­æå–æ•°æ®ï¼Œä»¥åŠåœ¨XMLæ–‡æ¡£ä¸­è¿›è¡Œæœç´¢å’Œè¿‡æ»¤æ“ä½œã€‚å®ƒæ˜¯[W3C](https://blog.csdn.net/weixin_48594833/article/details/121326752?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167948703016800225515738%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167948703016800225515738&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-121326752-null-null.142%5Ev76%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=W3C&spm=1018.2226.3001.4187)æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œè¢«å¹¿æ³›åº”ç”¨äºXMLæ–‡æ¡£çš„å¤„ç†å’Œåˆ†æã€‚

XPathä½¿ç”¨è·¯å¾„è¡¨è¾¾å¼æ¥æè¿°èŠ‚ç‚¹çš„ä½ç½®ï¼Œè¿™äº›è·¯å¾„è¡¨è¾¾å¼ç±»ä¼¼äºæ–‡ä»¶ç³»ç»Ÿä¸­çš„è·¯å¾„ã€‚è·¯å¾„è¡¨è¾¾å¼ç”±ä¸€ä¸ªæˆ–å¤šä¸ªæ­¥éª¤(step)ç»„æˆï¼Œæ¯ä¸ªæ­¥éª¤æè¿°äº†ä¸€ä¸ªèŠ‚ç‚¹æˆ–ä¸€ç»„èŠ‚ç‚¹ã€‚æ­¥éª¤å¯ä»¥ä½¿ç”¨[å…³ç³»è¿ç®—ç¬¦](https://so.csdn.net/so/search?q=%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6&spm=1001.2101.3001.7020)(å¦‚/å’Œ//)æ¥è¿æ¥ï¼Œä»¥ä¾¿æè¿°æ›´å¤æ‚çš„èŠ‚ç‚¹ä½ç½®ã€‚

XPathè¿˜æä¾›äº†ä¸€äº›å†…ç½®å‡½æ•°å’Œè¿ç®—ç¬¦ï¼Œå¯ä»¥å¯¹XMLæ–‡æ¡£ä¸­çš„æ•°æ®è¿›è¡Œæ“ä½œå’Œè®¡ç®—ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨XPathçš„æ•°å­¦å‡½æ•°æ¥è®¡ç®—èŠ‚ç‚¹çš„æ•°å€¼ï¼Œæˆ–ä½¿ç”¨å­—ç¬¦ä¸²å‡½æ•°æ¥å¤„ç†èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹ã€‚

åœ¨Pythonä¸­ï¼ŒXPathå¯ä»¥ä½¿ç”¨lxmlåº“æ¥å®ç°ã€‚lxmlæä¾›äº†ä¸€ä¸ª[etreeæ¨¡å—](https://blog.csdn.net/GrofChen/article/details/101211209?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167948712816800180668685%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167948712816800180668685&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-101211209-null-null.142%5Ev76%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=etree%E6%A8%A1%E5%9D%97&spm=1018.2226.3001.4187)ï¼Œè¯¥æ¨¡å—åŒ…å«äº†XPathçš„å®ç°ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å¯¹XMLæ–‡æ¡£è¿›è¡Œè§£æå’Œæ“ä½œï¼ŒåŒæ—¶æ”¯æŒXPathè¯­æ³•ã€‚

### Xpathè§£æ
#### èŠ‚ç‚¹é€‰æ‹©
XPathç”¨äºåœ¨XMLæ–‡æ¡£ä¸­å®šä½å’Œé€‰æ‹©èŠ‚ç‚¹ï¼Œä»¥ä¸‹æ˜¯XPathçš„ä¸€äº›å¸¸ç”¨ç”¨æ³•ï¼š  
![](https://cdn.nlark.com/yuque/0/2024/png/46412986/1726666077129-e46ec49e-9f28-4e23-83cd-56190afefd48.png)

**1. é€‰æ‹©æ‰€æœ‰èŠ‚ç‚¹ï¼š**

ä½¿ç”¨åŒæ–œæ //é€‰æ‹©æ–‡æ¡£ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œä¾‹å¦‚ï¼š`//node()`

**2. æŒ‰æ ‡ç­¾åé€‰æ‹©èŠ‚ç‚¹ï¼š**

ä½¿ç”¨æ ‡ç­¾åé€‰æ‹©èŠ‚ç‚¹ï¼Œä¾‹å¦‚ï¼š`//book`

**3. æŒ‰å±æ€§é€‰æ‹©èŠ‚ç‚¹ï¼š**

ä½¿ç”¨æ–¹æ‹¬å·[]å’Œ@ç¬¦å·é€‰æ‹©å…·æœ‰ç‰¹å®šå±æ€§å€¼çš„èŠ‚ç‚¹ï¼Œä¾‹å¦‚ï¼š`//book[@category="children"]`

**4. é€‰æ‹©çˆ¶èŠ‚ç‚¹ã€å­èŠ‚ç‚¹å’Œå…„å¼ŸèŠ‚ç‚¹ï¼š**

ä½¿ç”¨çˆ¶èŠ‚ç‚¹(â€¦)ã€å­èŠ‚ç‚¹(/)å’Œå…„å¼ŸèŠ‚ç‚¹(//)é€‰æ‹©èŠ‚ç‚¹ï¼Œä¾‹å¦‚ï¼š`//book/title/..`ã€`//book/author/following-sibling::title`ç­‰

**5. ä½¿ç”¨é€šé…ç¬¦é€‰æ‹©èŠ‚ç‚¹ï¼š**

ä½¿ç”¨æ˜Ÿå·*é€‰æ‹©ä»»ä½•èŠ‚ç‚¹ï¼Œä¾‹å¦‚ï¼š`//book/*`é€‰æ‹©æ‰€æœ‰bookèŠ‚ç‚¹çš„å­èŠ‚ç‚¹

**6. ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦é€‰æ‹©èŠ‚ç‚¹ï¼š**

ä½¿ç”¨andã€orã€notç­‰é€»è¾‘è¿ç®—ç¬¦é€‰æ‹©èŠ‚ç‚¹ï¼Œä¾‹å¦‚ï¼š`//book[price`

**7. ä½¿ç”¨å†…ç½®å‡½æ•°å¤„ç†èŠ‚ç‚¹ï¼š**

ä½¿ç”¨å†…ç½®å‡½æ•°å¤„ç†èŠ‚ç‚¹çš„æ–‡æœ¬å’Œæ•°å€¼ï¼Œä¾‹å¦‚ï¼š`//book[substring(title,1,3)="The"]`é€‰æ‹©æ ‡é¢˜ä»¥"The"å¼€å¤´çš„ä¹¦ç±

**8. ä½¿ç”¨è½´é€‰æ‹©èŠ‚ç‚¹ï¼š**

ä½¿ç”¨è½´é€‰æ‹©èŠ‚ç‚¹ï¼Œä¾‹å¦‚ï¼š`//book/ancestor::library`é€‰æ‹©bookèŠ‚ç‚¹çš„libraryç¥–å…ˆèŠ‚ç‚¹

åœ¨Pythonä¸­ï¼Œä½¿ç”¨lxmlåº“çš„etreeæ¨¡å—å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨XPathè¿›è¡ŒèŠ‚ç‚¹å®šä½å’Œé€‰æ‹©ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨[etree.parse()å‡½æ•°](https://blog.csdn.net/qq_35208583/article/details/89041912?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167948747816800184134255%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=167948747816800184134255&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-1-89041912-null-null.142%5Ev76%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=etree.parse%28%29%E5%87%BD%E6%95%B0&spm=1018.2226.3001.4187)è§£æXMLæ–‡æ¡£ï¼Œå¹¶ä½¿ç”¨xpath()æ–¹æ³•æ‰§è¡ŒXPathè¡¨è¾¾å¼ï¼Œä»¥ä¾¿é€‰æ‹©å’Œæ“ä½œXMLæ–‡æ¡£ä¸­çš„èŠ‚ç‚¹ã€‚

#### è·¯å¾„è¡¨è¾¾å¼
![](https://cdn.nlark.com/yuque/0/2024/png/46412986/1726666077734-e44aee0d-7d7f-45b2-be77-31c54dc074fb.png)

XPathè·¯å¾„è¡¨è¾¾å¼æ˜¯ä¸€ç§ç”¨äºåœ¨XMLæ–‡æ¡£ä¸­å®šä½èŠ‚ç‚¹çš„è¯­æ³•ã€‚å®ƒç”±ä¸€ç³»åˆ—èŠ‚ç‚¹åã€è½´ã€è°“è¯å’Œè¿ç®—ç¬¦ç»„æˆï¼Œå¯ä»¥æ„é€ å‡ºä¸€ä¸ªå®Œæ•´çš„è·¯å¾„ï¼Œä»¥å®šä½åˆ°ç›®æ ‡èŠ‚ç‚¹ã€‚

XPathè·¯å¾„è¡¨è¾¾å¼çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š

```plain
/          : ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œå®šä½åˆ°ç›®æ ‡èŠ‚ç‚¹
//         : ä»å½“å‰èŠ‚ç‚¹å¼€å§‹ï¼Œé€’å½’æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹
.          : è¡¨ç¤ºå½“å‰èŠ‚ç‚¹
..         : è¡¨ç¤ºå½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹
*          : åŒ¹é…ä»»æ„èŠ‚ç‚¹
@          : è¡¨ç¤ºå±æ€§èŠ‚ç‚¹
[]         : è¡¨ç¤ºè°“è¯ï¼Œç”¨äºç­›é€‰ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹

```

ä¾‹å¦‚ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›XPathè·¯å¾„è¡¨è¾¾å¼çš„ç¤ºä¾‹ï¼š

```plain
/                 : å®šä½åˆ°æ ¹èŠ‚ç‚¹
/bookstore        : å®šä½åˆ°æ ¹èŠ‚ç‚¹ä¸‹çš„bookstoreèŠ‚ç‚¹
/bookstore/book   : å®šä½åˆ°bookstoreèŠ‚ç‚¹ä¸‹çš„æ‰€æœ‰bookèŠ‚ç‚¹
//book            : é€’å½’æŸ¥æ‰¾æ‰€æœ‰bookèŠ‚ç‚¹
//book[@category='web'] : æŸ¥æ‰¾æ‰€æœ‰categoryå±æ€§å€¼ä¸ºwebçš„bookèŠ‚ç‚¹

```

XPathè·¯å¾„è¡¨è¾¾å¼æ˜¯XPathè¯­è¨€çš„æ ¸å¿ƒï¼Œå®ƒå¯ä»¥ç”¨äºæŸ¥è¯¢XMLæ–‡æ¡£ä¸­çš„æ•°æ®ï¼Œå¹¶ä¸”åœ¨XPathè¯­è¨€ä¸­è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„åŠŸèƒ½ï¼Œä¾‹å¦‚å‡½æ•°ã€è¿ç®—ç¬¦ç­‰ï¼Œå¯ä»¥æ›´åŠ çµæ´»åœ°å¤„ç†XMLæ•°æ®ã€‚

#### è°“è¯­
XPathè°“è¯­æ˜¯ä¸€ç§ç”¨äºç­›é€‰XMLæ–‡æ¡£ä¸­ç‰¹å®šèŠ‚ç‚¹çš„è¡¨è¾¾å¼ï¼Œå®ƒå¯ä»¥åœ¨XPathè·¯å¾„ä¸­ä½¿ç”¨ã€‚è°“è¯­é€šå¸¸ç”±æ–¹æ‹¬å·åŒ…å›´ï¼Œå¹¶åŒ…æ‹¬ä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼ã€‚

ä¾‹å¦‚ï¼Œä»¥ä¸‹XPathè·¯å¾„é€‰æ‹©æ‰€æœ‰åä¸ºâ€œbookâ€çš„å…ƒç´ ï¼š

```plain
/bookstore/book

```

å¦‚æœæˆ‘ä»¬æƒ³è¦é€‰æ‹©æ‰€æœ‰å…·æœ‰ä»·æ ¼å¤§äº10ç¾å…ƒçš„ä¹¦ç±ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹XPathè·¯å¾„å’Œè°“è¯­ï¼š

```plain
/bookstore/book[price > 10]

```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè°“è¯­æ˜¯â€œ[price > 10]â€ï¼Œå®ƒæŒ‡å®šäº†ä¸€ä¸ªæ¡ä»¶ï¼Œå®ƒåªé€‰æ‹©ä»·æ ¼å¤§äº10ç¾å…ƒçš„ä¹¦ç±ã€‚

![](https://cdn.nlark.com/yuque/0/2024/png/46412986/1726666077753-c5049d77-a563-4138-a016-3094899feab7.png)

#### æœªçŸ¥èŠ‚ç‚¹
å½“æˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€ä¸ªæœªçŸ¥èŠ‚ç‚¹æ—¶ï¼Œæ„å‘³ç€æˆ‘ä»¬æ— æ³•ç¡®å®šèŠ‚ç‚¹çš„ä½ç½®æˆ–åç§°ï¼Œä½†æˆ‘ä»¬çŸ¥é“èŠ‚ç‚¹å…·æœ‰æŸäº›ç‰¹å®šå±æ€§æˆ–ç‰¹å¾ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ã€è½´ã€è°“è¯ç­‰æŠ€æœ¯æ¥é€‰æ‹©æœªçŸ¥èŠ‚ç‚¹ã€‚

é€šé…ç¬¦ï¼ˆ*ï¼‰å¯ä»¥ç”¨æ¥åŒ¹é…ä»»ä½•èŠ‚ç‚¹ï¼Œè½´å¯ä»¥ç”¨æ¥é€‰æ‹©ä¸å½“å‰èŠ‚ç‚¹ç›¸å…³çš„èŠ‚ç‚¹ï¼Œè°“è¯å¯ä»¥ç”¨æ¥ç­›é€‰ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ã€‚ä½¿ç”¨è¿™äº›æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä»»ä½•æœªçŸ¥èŠ‚ç‚¹ï¼Œä½¿æˆ‘ä»¬çš„XPathè¡¨è¾¾å¼æ›´åŠ çµæ´»å’Œé€šç”¨ã€‚

![](https://cdn.nlark.com/yuque/0/2024/png/46412986/1726666077817-2ddd2e36-65fc-4669-87f3-565f0725ce2e.png)

Xpathè¯­æ³•è¾ƒå¤šï¼Œæˆ‘ä¸ä¸€ä¸€æ¼”ç¤ºï¼Œä½†åœ¨åé¢å®æˆ˜æ¼”ç¤ºä¸­ï¼Œä¼šä¾æ¬¡è®²è§£ï¼Œå¸®åŠ©å¤§å®¶ç†è§£å­¦ä¹ ã€‚ç†è®ºè®²è§£å®Œæ¯•ï¼Œæˆ‘ä»¬è¿›å…¥å®æˆ˜ï¼ï¼ï¼ ğŸ’¨ğŸ’¨

## jsonæ¨¡å—
### åˆ—è¡¨/å­—å…¸===>jsonï¼ˆdumpsï¼‰
```python
import json
# å‡†å¤‡åˆ—è¡¨ï¼Œåˆ—è¡¨å†…æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯å­—å…¸ï¼Œå°†å…¶è½¬æ¢ä¸ºJSON
data = [{"name": "å¼ å¤§å±±", "age": 11}, {"name": "ç‹å¤§é”¤", "age": 13}, {"name": "èµµå°è™", "age": 16}]
json_str = json.dumps(data, ensure_ascii=False)# ensure_ascii=Falseè¡¨ç¤ºä¸è½¬ç 
print(type(json_str))
print(json_str)

# å‡†å¤‡å­—å…¸ï¼Œå°†å­—å…¸è½¬æ¢ä¸ºJSON
d = {"name":"å‘¨æ°è½®", "addr":"å°åŒ—"}
json_str = json.dumps(d, ensure_ascii=False)
print(type(json_str))
print(json_str)

```

### json==>åˆ—è¡¨/å­—å…¸ï¼ˆloadsï¼‰
```python
import json

# å°†JSONå­—ç¬¦ä¸²è½¬æ¢ä¸ºPythonæ•°æ®ç±»å‹[{k: v, k: v}, {k: v, k: v}]
s = '[{"name": "å¼ å¤§å±±", "age": 11}, {"name": "ç‹å¤§é”¤", "age": 13}, {"name": "èµµå°è™", "age": 16}]'
l = json.loads(s)
print(type(l))
print(l)
# å°†JSONå­—ç¬¦ä¸²è½¬æ¢ä¸ºPythonæ•°æ®ç±»å‹{k: v, k: v}
s = '{"name": "å‘¨æ°è½®", "addr": "å°åŒ—"}'
d = json.loads(s)
print(type(d))
print(d)

```

### è¾“å‡ºjsonåˆ°æ–‡ä»¶ï¼ˆdumpï¼‰
```python
import json
data = {"name": "John", "age": 30}
with open('data.json', 'w') as f:
    json.dump(data, f)

```

### ä»jsonæ–‡ä»¶ä¸­è¯»æ•°æ®ï¼ˆloadï¼‰
```python
with open('data.json', 'r') as f:
    data = json.load(f)
    print(data)  # è¾“å‡º: {'name': 'John', 'age': 30}

```

